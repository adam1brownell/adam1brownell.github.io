---
import BaseHead      from '../components/BaseHead.astro';
import Header        from '../components/Header.astro';
import Footer        from '../components/Footer.astro';
import { SITE_TITLE, SITE_DESCRIPTION } from '../consts';
import { getCollection } from 'astro:content';
import FormattedDate from '../components/FormattedDate.astro';

// Grab & sort your markdown posts
const posts = (await getCollection('blog'))
  .sort((a, b) => Date.parse(b.data.pubDate) - Date.parse(a.data.pubDate));
---

<!DOCTYPE html>
<html lang="en">
  <head>
    <BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} />
  </head>
  <body>
    <Header />
    <main style="max-width:960px; margin:2rem auto; padding:0 1rem;">
      <ul style="list-style:none; padding:0; display:flex; flex-wrap:wrap; gap:2rem;">
        {posts.map((post) => (
          <li style="width:calc(50% - 1rem);">
            <a
              href={`/blog/${post.slug}/`}
              style="color:#007acc; text-decoration:none;"
            >
              <img
                src={`${Astro.base}${post.data.image}`}
                width="720"
                height="360"
                alt=""
                style="border-radius:12px; margin-bottom:0.5rem;"
              />
              <h4 class="title">{post.data.title}</h4>
              <p class="date">
                <FormattedDate date={post.data.pubDate} />
              </p>
            </a>
          </li>
        ))}
      </ul>
    </main>
    <Footer />
  </body>
</html>
